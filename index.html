<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîì Vulnerable Banking App - Test Security</title>
    
    <!-- üî¥ VULNERABILIT√Ä #1: Contenuto misto (Mixed Content) -->
    <link rel="stylesheet" href="http://insecure-cdn.com/styles.css">
    
    <!-- üî¥ VULNERABILIT√Ä #2: Inline styles con CSS Injection vulnerability -->
    <style>
        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            padding: 20px;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }
        
        h1 { color: #333; text-align: center; }
        .warning { background: #ff6b6b; color: white; padding: 15px; border-radius: 5px; margin: 20px 0; }
        .vulnerability-list { background: #f8f9fa; padding: 20px; border-left: 4px solid #dc3545; }
        input, textarea { width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #ddd; border-radius: 4px; }
        button { background: #667eea; color: white; padding: 12px 30px; border: none; border-radius: 5px; cursor: pointer; font-size: 16px; }
        button:hover { background: #5568d3; }
        .output { background: #e9ecef; padding: 15px; margin: 15px 0; border-radius: 5px; min-height: 50px; }
        .credentials { background: #fff3cd; border: 1px solid #ffc107; padding: 10px; margin: 10px 0; }
    </style>
    
    <!-- üî¥ VULNERABILIT√Ä #3: Script esterno non sicuro -->
    <script src="http://untrusted-source.com/analytics.js"></script>
    
    <!-- üî¥ VULNERABILIT√Ä #4: jQuery vulnerabile (vecchia versione) -->
    <script src="https://code.jquery.com/jquery-1.6.4.min.js"></script>
</head>
<body>

<div class="container">
    <h1>üè¶ Vulnerable Banking Application</h1>
    
    <div class="warning">
        ‚ö†Ô∏è <strong>ATTENZIONE:</strong> Questa pagina contiene 10+ vulnerabilit√† intenzionali per scopo didattico!<br>
        <strong>NON USARE</strong> in produzione! Solo per testing di security scanner.
    </div>

    <!-- ============================================ -->
    <!-- üî¥ VULNERABILIT√Ä #5: Reflected XSS          -->
    <!-- ============================================ -->
    <section id="xss-section">
        <h2>üíâ 1. Test XSS (Reflected)</h2>
        <p>Inserisci il tuo nome per un saluto personalizzato:</p>
        <input type="text" id="userName" placeholder="Il tuo nome">
        <button onclick="displayGreeting()">Saluta</button>
        <div id="greeting" class="output"></div>
    </section>

    <!-- ============================================ -->
    <!-- üî¥ VULNERABILIT√Ä #6: DOM-Based XSS          -->
    <!-- ============================================ -->
    <section id="dom-xss">
        <h2>üéØ 2. Test DOM XSS</h2>
        <p>Cerca un prodotto:</p>
        <input type="text" id="searchQuery" placeholder="Cerca...">
        <button onclick="performSearch()">Cerca</button>
        <div id="searchResults" class="output"></div>
    </section>

    <!-- ============================================ -->
    <!-- üî¥ VULNERABILIT√Ä #7: SQL Injection via Form -->
    <!-- ============================================ -->
    <section id="sql-injection">
        <h2>üîë 3. Login (SQL Injection)</h2>
        <form id="loginForm" onsubmit="return handleLogin(event)">
            <input type="text" id="username" placeholder="Username" required>
            <input type="password" id="password" placeholder="Password" required>
            <button type="submit">Login</button>
        </form>
        <div id="loginResult" class="output"></div>
        
        <div class="credentials">
            üí° <strong>Hint per test:</strong><br>
            Username: admin' OR '1'='1<br>
            Password: qualsiasi cosa
        </div>
    </section>

    <!-- ============================================ -->
    <!-- üî¥ VULNERABILIT√Ä #8: Hardcoded Credentials  -->
    <!-- ============================================ -->
    <section id="hardcoded-creds">
        <h2>üîê 4. Admin Panel (Credenziali Hardcoded)</h2>
        <button onclick="accessAdminPanel()">Accedi Admin Panel</button>
        <div id="adminResult" class="output"></div>
    </section>

    <!-- ============================================ -->
    <!-- üî¥ VULNERABILIT√Ä #9: Sensitive Data Exposure -->
    <!-- ============================================ -->
    <section id="data-exposure">
        <h2>üí≥ 5. Informazioni Account</h2>
        <button onclick="showAccountDetails()">Mostra Dettagli</button>
        <div id="accountDetails" class="output"></div>
    </section>

    <!-- ============================================ -->
    <!-- üî¥ VULNERABILIT√Ä #10: Insecure Direct Object Reference -->
    <!-- ============================================ -->
    <section id="idor">
        <h2>üìÑ 6. Visualizza Documento</h2>
        <p>ID Documento:</p>
        <input type="number" id="docId" value="1" min="1">
        <button onclick="loadDocument()">Carica Documento</button>
        <div id="documentContent" class="output"></div>
    </section>

    <!-- ============================================ -->
    <!-- Lista vulnerabilit√† rilevabili                -->
    <!-- ============================================ -->
    <section class="vulnerability-list">
        <h2>üêõ Vulnerabilit√† Presenti in Questa Pagina:</h2>
        <ol>
            <li><strong>Mixed Content</strong> - HTTP resources su HTTPS page</li>
            <li><strong>Reflected XSS</strong> - Input non sanitizzato in displayGreeting()</li>
            <li><strong>DOM-Based XSS</strong> - innerHTML manipulation in performSearch()</li>
            <li><strong>SQL Injection</strong> - Query string construction nel form login</li>
            <li><strong>Hardcoded Credentials</strong> - Admin password nel codice</li>
            <li><strong>Sensitive Data Exposure</strong> - Credit card in plain text</li>
            <li><strong>Insecure Direct Object Reference (IDOR)</strong> - Accesso documenti</li>
            <li><strong>Missing CSRF Protection</strong> - Nessun token CSRF nei form</li>
            <li><strong>Outdated Libraries</strong> - jQuery 1.6.4 (vulnerabile)</li>
            <li><strong>Insecure External Resources</strong> - Script da fonte non attendibile</li>
            <li><strong>Information Disclosure</strong> - Commenti HTML con info sensibili</li>
            <li><strong>Client-Side Validation Only</strong> - Nessuna validazione server</li>
        </ol>
    </section>

    <!-- üî¥ VULNERABILIT√Ä #11: Information Disclosure in HTML Comments -->
    <!-- 
    TODO: Remove before production!
    Database credentials:
    - Host: db.production.local
    - User: root
    - Password: SuperSecret123!
    - Database: banking_prod
    
    API Keys:
    - AWS: AKIAIOSFODNN7EXAMPLE
    - Stripe: sk_live_51HxYzKJxYzKJxYzKJ
    
    Internal endpoints:
    - /api/admin/users
    - /api/admin/transactions
    - /debug/show_all_data
    -->

</div>

<!-- ============================================ -->
<!-- JavaScript vulnerabile                       -->
<!-- ============================================ -->
<script>
    // üî¥ VULNERABILIT√Ä #5: Reflected XSS
    function displayGreeting() {
        const userName = document.getElementById('userName').value;
        // VULNERABILE: Inserisce direttamente HTML senza sanitizzazione
        document.getElementById('greeting').innerHTML = 
            '<h3>Ciao ' + userName + '! üëã</h3>';
        // Exploit: <img src=x onerror=alert('XSS')>
        // Exploit: <script>alert(document.cookie)</script>
    }

    // üî¥ VULNERABILIT√Ä #6: DOM-Based XSS
    function performSearch() {
        const query = document.getElementById('searchQuery').value;
        // VULNERABILE: location.hash pu√≤ essere manipolato
        window.location.hash = query;
        const searchTerm = window.location.hash.substring(1);
        
        // VULNERABILE: innerHTML con input utente
        document.getElementById('searchResults').innerHTML = 
            '<p>Risultati per: <strong>' + decodeURIComponent(searchTerm) + '</strong></p>' +
            '<p>Nessun risultato trovato.</p>';
        // Exploit: #<img src=x onerror=alert('DOM XSS')>
    }

    // üî¥ VULNERABILIT√Ä #7: SQL Injection (simulato client-side)
    function handleLogin(event) {
        event.preventDefault();
        const username = document.getElementById('username').value;
        const password = document.getElementById('password').value;
        
        // VULNERABILE: Costruzione query SQL con concatenazione
        // In un'app reale, questo sarebbe server-side
        const sqlQuery = "SELECT * FROM users WHERE username='" + username + 
                        "' AND password='" + password + "'";
        
        document.getElementById('loginResult').innerHTML = 
            '<div style="background: #fff3cd; padding: 10px; border-radius: 5px;">' +
            '<strong>Query SQL generata:</strong><br>' +
            '<code style="color: #dc3545;">' + sqlQuery + '</code><br><br>' +
            '<strong>‚ö†Ô∏è VULNERABILE A SQL INJECTION!</strong><br>' +
            'Un attaccante pu√≤ usare: <code>admin\' OR \'1\'=\'1</code>' +
            '</div>';
        
        // Simula bypass autenticazione
        if (username.includes("' OR '") || username.includes("1=1")) {
            document.getElementById('loginResult').innerHTML += 
                '<div style="background: #d4edda; padding: 10px; margin-top: 10px; border-radius: 5px;">' +
                '‚úÖ <strong>Login riuscito!</strong> (Bypassata autenticazione con SQL Injection)' +
                '</div>';
        }
        
        return false;
    }

    // üî¥ VULNERABILIT√Ä #8: Hardcoded Credentials
    function accessAdminPanel() {
        // VULNERABILE: Credenziali hardcoded nel JavaScript
        const ADMIN_USERNAME = "admin";
        const ADMIN_PASSWORD = "SuperAdmin2024!";
        const API_KEY = "sk_live_51HxYzKJxYzKJxYzKJ";
        const DB_CONNECTION = "mysql://root:password123@localhost:3306/banking";
        
        document.getElementById('adminResult').innerHTML = 
            '<div style="background: #f8d7da; padding: 15px; border-radius: 5px;">' +
            'üî¥ <strong>CREDENZIALI HARDCODED RILEVATE!</strong><br><br>' +
            '<strong>Admin Username:</strong> ' + ADMIN_USERNAME + '<br>' +
            '<strong>Admin Password:</strong> ' + ADMIN_PASSWORD + '<br>' +
            '<strong>API Key:</strong> ' + API_KEY + '<br>' +
            '<strong>DB Connection:</strong> ' + DB_CONNECTION + '<br><br>' +
            '‚ö†Ô∏è Queste credenziali sono visibili nel codice sorgente!' +
            '</div>';
    }

    // üî¥ VULNERABILIT√Ä #9: Sensitive Data Exposure
    function showAccountDetails() {
        // VULNERABILE: Dati sensibili in chiaro
        const accountData = {
            accountNumber: "IT60X0542811101000000123456",
            creditCard: "4532-1234-5678-9012",
            cvv: "123",
            ssn: "RSSMRA80A01H501U",
            balance: "‚Ç¨ 15,420.50",
            pin: "1234"
        };
        
        document.getElementById('accountDetails').innerHTML = 
            '<div style="background: #fff3cd; padding: 15px; border-radius: 5px;">' +
            '‚ö†Ô∏è <strong>DATI SENSIBILI ESPOSTI!</strong><br><br>' +
            '<strong>IBAN:</strong> ' + accountData.accountNumber + '<br>' +
            '<strong>Carta di Credito:</strong> ' + accountData.creditCard + '<br>' +
            '<strong>CVV:</strong> ' + accountData.cvv + '<br>' +
            '<strong>Codice Fiscale:</strong> ' + accountData.ssn + '<br>' +
            '<strong>PIN:</strong> ' + accountData.pin + '<br>' +
            '<strong>Saldo:</strong> ' + accountData.balance + '<br><br>' +
            'üî¥ Questi dati non dovrebbero MAI essere esposti lato client!' +
            '</div>';
    }

    // üî¥ VULNERABILIT√Ä #10: Insecure Direct Object Reference (IDOR)
    function loadDocument() {
        const docId = document.getElementById('docId').value;
        
        // VULNERABILE: Nessun controllo di autorizzazione
        // Un attaccante pu√≤ cambiare l'ID per accedere documenti altrui
        const documents = {
            1: "Estratto conto Mario Rossi - Gennaio 2025",
            2: "Contratto prestito Luigi Bianchi - Confidenziale",
            3: "Dati personali Anna Verdi - PRIVATO",
            4: "Transazioni admin - SOLO INTERNO",
            5: "Backup database - RISERVATO"
        };
        
        document.getElementById('documentContent').innerHTML = 
            '<div style="background: #f8d7da; padding: 15px; border-radius: 5px;">' +
            'üî¥ <strong>IDOR VULNERABILITY!</strong><br><br>' +
            '<strong>Documento #' + docId + ':</strong><br>' +
            (documents[docId] || 'Documento non trovato') + '<br><br>' +
            '‚ö†Ô∏è Nessun controllo di autorizzazione!<br>' +
            'Un attaccante pu√≤ accedere a QUALSIASI documento cambiando l\'ID!' +
            '</div>';
    }

    // üî¥ VULNERABILIT√Ä #12: Insecure Random
    function generateToken() {
        // VULNERABILE: Math.random() non √® crittograficamente sicuro
        return Math.random().toString(36).substring(2, 15);
    }

    // üî¥ VULNERABILIT√Ä #13: Local Storage con dati sensibili
    function saveCredentials() {
        // VULNERABILE: Dati sensibili in localStorage
        localStorage.setItem('username', 'admin');
        localStorage.setItem('password', 'Admin123!');
        localStorage.setItem('sessionToken', generateToken());
        localStorage.setItem('creditCard', '4532-1234-5678-9012');
    }

    // Auto-save credentials (simulato)
    setTimeout(saveCredentials, 1000);

    // üî¥ VULNERABILIT√Ä #14: Console.log con info sensibili
    console.log('üî¥ SECURITY WARNING: Sensitive data in console!');
    console.log('Admin credentials: admin / SuperAdmin2024!');
    console.log('Database: mysql://root:password123@db.internal:3306/banking');
    console.log('API Endpoint: https://api.internal.bank/v1/admin');
    console.log('Session Token: ' + generateToken());

    // üî¥ VULNERABILIT√Ä #15: Eval con input utente (estremo)
    function calculateExpression() {
        const expr = prompt('Inserisci espressione matematica:');
        if (expr) {
            // ESTREMAMENTE VULNERABILE: eval con input utente
            try {
                const result = eval(expr);
                alert('Risultato: ' + result);
            } catch (e) {
                alert('Errore: ' + e.message);
            }
        }
    }

    // Event listeners
    document.addEventListener('DOMContentLoaded', function() {
        console.log('üîì Vulnerable Banking App loaded');
        console.log('‚ö†Ô∏è This page contains 15+ intentional vulnerabilities!');
    });
</script>

<!-- Link a file esterni vulnerabili -->
<script src="webresources/vulnerable-utils.js"></script>
</body>
</html>